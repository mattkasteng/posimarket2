# üõ°Ô∏è Plano de Pentest e Varreduras de Seguran√ßa

Este documento descreve o processo cont√≠nuo de testes de seguran√ßa para o PosiMarket, cobrindo varreduras automatizadas, pentests manuais e governan√ßa de corre√ß√µes.

## üéØ Objetivos

- Identificar vulnerabilidades antes que atinjam produ√ß√£o
- Garantir que todas as corre√ß√µes sejam rastreadas e audit√°veis
- Manter conformidade com requisitos LGPD, ISO 27001 e SOC 2

## üîÅ Ciclo Cont√≠nuo de Seguran√ßa (DevSecOps)

1. **A cada push / PR** (CI):
   - `npm run security:scan`
     - ESLint (boas pr√°ticas e falhas OWASP b√°sicas)
     - Type Check (consist√™ncia e preven√ß√£o de falhas de tipagem)
     - `npm audit --audit-level=moderate`
   - Testes unit√°rios (`npm run test:ci`)
   - Testes E2E cr√≠ticos (`npm run test:e2e` em pipelines noturnos)

2. **Semanalmente**:
   - Revisar relat√≥rio gerado por `npm run security:scan`
   - Atualizar depend√™ncias vulner√°veis
   - Registrar falhas em `docs/security/` com status de corre√ß√£o

3. **Trimestralmente**:
   - Executar **pentest interno** (time de seguran√ßa) seguindo checklist OWASP Top 10
   - Executar varredura din√¢mica (DAST) com ferramentas como OWASP ZAP (documentar resultados)
   - Revisar pol√≠ticas de acesso e rota√ß√£o de chaves

4. **Anualmente**:
   - Pentest externo conduzido por consultoria especializada
   - Revis√£o completa de arquitetura, backup/DR, MFA, API keys e logs

## üß™ Execu√ß√£o do Script Automatizado

O comando abaixo re√∫ne as principais verifica√ß√µes autom√°ticas:

```bash
npm run security:scan
```

Sa√≠da esperada:
- Status de lint, type-check e audit
- Logs detalhados em caso de falha
- C√≥digo de sa√≠da ‚â† 0 quando houver vulnerabilidades (ideal para CI/CD)

## üîç Pentest Manual (Resumo)

| Etapa | Ferramentas | Evid√™ncia |
| --- | --- | --- |
| Enumera√ß√£o | `nmap`, `dirsearch`, `burp suite` | logs de varredura |
| Autentica√ß√£o | Testes de MFA, brute force controlado | prints / relat√≥rios |
| Autoriza√ß√£o | Tentativas de IDOR, RBAC, GraphQL? | evid√™ncias de sucesso/fracasso |
| Inje√ß√µes | SQLi, XSS, SSRF, Template Injection | relat√≥rios com PoC |
| APIs | Rate limiting, prote√ß√£o CSRF, tokens | capturas de requisi√ß√µes |
| Criptografia | Verificar TLS, headers, armazenamento | relat√≥rio t√©cnico |

Todos os achados devem ser registrados no backlog de seguran√ßa com:
- Severidade (CVSS v3)
- Prazo de corre√ß√£o conforme SLA:
  - Cr√≠tica: 24h
  - Alta: 72h
  - M√©dia: 7 dias
  - Baixa: 30 dias

## üìÇ Evid√™ncias & Relat√≥rios

- **Relat√≥rio mensal**: anexar em `docs/auditoria/RELATORIO-SEGURANCA-YYYY-MM.md`
- **Relat√≥rio de pentest externo**: armazenado em reposit√≥rio privado + resumo em `docs/auditoria`
- **Logs de execu√ß√£o**: incluir sa√≠da consolidada do `security:scan` em pipeline CI (artefatos)

## üë• Responsabilidades

| Fun√ß√£o | Respons√°vel | Entreg√°veis |
| --- | --- | --- |
| Tech Lead | @time-dev | Monitorar execu√ß√£o do script automatizado e atualiza√ß√£o de depend√™ncias |
| Seguran√ßa | @time-seg | Conduzir pentest trimestral e atualizar matriz de riscos |
| DPO / Compliance | @time-compliance | Garantir que evid√™ncias estejam dispon√≠veis para auditorias |

## üöÄ Pr√≥ximos Passos

1. Integrar `npm run security:scan` ao pipeline CI/CD (GitHub Actions/Vercel)
2. Automatizar execu√ß√£o de OWASP ZAP (DAST) com relat√≥rio HTML anexado
3. Contratar pentest externo e anexar laudo anual
4. Adicionar m√©tricas de seguran√ßa (tempo m√©dio de corre√ß√£o, cobertura de testes) ao dashboard interno

---

> **Nota**: Nenhum destes processos altera as funcionalidades do marketplace. Scripts de seguran√ßa executam apenas verifica√ß√µes de leitura, sem modificar dados ou schema.
